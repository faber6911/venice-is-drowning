"1986-01-01 00:00:00")) -> partial
result %>% filter(datetime != c("1984-01-01 00:00:00",
"1985-01-01 00:00:00",
"1986-01-01 00:00:00",
"1987-01-01 00:00:00",
"1988-01-01 00:00:00",
"1989-01-01 00:00:00",
"1990-01-01 00:00:00",
"1991-01-01 00:00:00",
"1992-01-01 00:00:00",
"1993-01-01 00:00:00",
"1994-01-01 00:00:00",
"1995-01-01 00:00:00",
"1996-01-01 00:00:00",
"1997-01-01 00:00:00",
"1998-01-01 00:00:00",
"1999-01-01 00:00:00",
"2000-01-01 00:00:00",
"2001-01-01 00:00:00",
"2002-01-01 00:00:00",)) -> partial
result %>% filter(datetime != c("1984-01-01 00:00:00",
"1985-01-01 00:00:00",
"1986-01-01 00:00:00",
"1987-01-01 00:00:00",
"1988-01-01 00:00:00",
"1989-01-01 00:00:00",
"1990-01-01 00:00:00",
"1991-01-01 00:00:00",
"1992-01-01 00:00:00",
"1993-01-01 00:00:00",
"1994-01-01 00:00:00",
"1995-01-01 00:00:00",
"1996-01-01 00:00:00",
"1997-01-01 00:00:00",
"1998-01-01 00:00:00",
"1999-01-01 00:00:00",
"2000-01-01 00:00:00",
"2001-01-01 00:00:00",
"2002-01-01 00:00:00")) -> partial
result %>% filter(datetime == c("1984-01-01 00:00:00",
"1985-01-01 00:00:00",
"1986-01-01 00:00:00",
"1987-01-01 00:00:00",
"1988-01-01 00:00:00",
"1989-01-01 00:00:00",
"1990-01-01 00:00:00",
"1991-01-01 00:00:00",
"1992-01-01 00:00:00",
"1993-01-01 00:00:00",
"1994-01-01 00:00:00",
"1995-01-01 00:00:00",
"1996-01-01 00:00:00",
"1997-01-01 00:00:00",
"1998-01-01 00:00:00",
"1999-01-01 00:00:00",
"2000-01-01 00:00:00",
"2001-01-01 00:00:00",
"2002-01-01 00:00:00")) -> partial
result_tmp <- do.call(rbind, tt)
result <- data.frame(datetime= (result_tmp$date + seconds(result_tmp$time)),
dir_wind=result_tmp$dir_wind,
vel_wind = result_tmp$vel_wind,
rain = result_tmp$rain)
result %>% filter(datetime == c("1984-01-01 00:00:00",
"1985-01-01 00:00:00",
"1986-01-01 00:00:00",
"1987-01-01 00:00:00",
"1988-01-01 00:00:00",
"1989-01-01 00:00:00",
"1990-01-01 00:00:00",
"1991-01-01 00:00:00",
"1992-01-01 00:00:00",
"1993-01-01 00:00:00",
"1994-01-01 00:00:00",
"1995-01-01 00:00:00",
"1996-01-01 00:00:00",
"1997-01-01 00:00:00",
"1998-01-01 00:00:00",
"1999-01-01 00:00:00",
"2000-01-01 00:00:00",
"2001-01-01 00:00:00",
"2002-01-01 00:00:00")) -> partial
result %>% filter(datetime >= "1984-12-31 23:00:00")
result %>% filter(datetime > "1984-12-31 23:00:00")
library(dplyr)
dplr <- left_join(result, tides_filtered, by=c("datetime","datetime"))
head(dplr)
anyNA(dplr)
library(knitr)
library(rmdformats)
## Global options
options(max.print="75")
opts_chunk$set(echo=FALSE,
cache=TRUE,
prompt=FALSE,
tidy=TRUE,
comment=NA,
message=FALSE,
warning=FALSE)
opts_knit$set(width=75)
library(readr)
library(lubridate)
library(xts)
data_1983 <- read_delim("../data/tides/Punta_Salute_1983.csv", delim=";", locale=locale("it"),
col_types = cols(
col_date("%d-%b-%y"),
col_time("%H:%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1,
n_max=24*365)
data_1984 <- read_delim("../data/tides/Punta_Salute_1984.csv", delim=";", locale=locale("it"),
col_types = cols(
col_date("%d-%b-%y"),
col_time("%H.%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1,
n_max=24*366)
data_1985 <- read_delim("../data/tides/Punta_Salute_1985.csv", delim=";", locale=locale("it"),
col_types = cols(
col_date("%d-%b-%y"),
col_time("%H.%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1)
data_1986 <- read_delim("../data/tides/Punta_Salute_1986.csv", delim=";", locale=locale("it"),
col_types = cols(
col_date("%d-%b-%y"),
col_time("%H.%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1)
data_1987 <- read_delim("../data/tides/Punta_Salute_1987.csv", delim=";", locale=locale("it"),
col_types = cols(
col_date("%d-%b-%y"),
col_time("%H.%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1)
data_1988 <- read_delim("../data/tides/Punta_Salute_1988.csv", delim=";", locale=locale("it"),
col_types = cols(
col_date("%d-%b-%y"),
col_time("%H.%M"),
col_number(),
col_skip()),
col_names=c("date", "time", "level"),
skip=1)
data_1989 <- read_delim("../data/tides/Punta_Salute_1989.csv", delim=";", locale=locale("it"),
col_types = cols(
col_date("%d-%b-%y"),
col_time("%H.%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1)
data_1990 <- read_delim("../data/tides/Punta_Salute_1990.csv", delim=";", locale=locale("it"),
col_types = cols(
col_date("%d-%b-%y"),
col_time("%H.%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1)
data_1991 <- read_delim("../data/tides/Punta_Salute_1991.csv", delim=";", locale=locale("it"),
col_types = cols(
col_date("%d-%b-%y"),
col_time("%H.%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1)
data_1992 <- read_delim("../data/tides/Punta_Salute_1992.csv", delim=";", locale=locale("it"),
col_types = cols(
col_date("%d-%b-%y"),
col_time("%H.%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1)
data_1993 <- read_delim("../data/tides/Punta_Salute_1993.csv", delim=";", locale=locale("it"),
col_types = cols(
col_date("%d-%b-%y"),
col_time("%H.%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1)
data_1994 <- read_delim("../data/tides/Punta_Salute_1994.csv", delim=";", locale=locale("it"),
col_types = cols(
col_date("%d-%b-%y"),
col_time("%H.%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1)
data_1995 <- read_delim("../data/tides/Punta_Salute_1995.csv", delim=";", locale=locale("it"),
col_types = cols(
col_date("%d-%b-%y"),
col_time("%H.%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1)
data_1996 <- read_delim("../data/tides/Punta_Salute_1996.csv", delim=";", locale=locale("it"),
col_types = cols(
col_date("%d-%b-%y"),
col_time("%H.%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1)
data_1997 <- read_delim("../data/tides/Punta_Salute_1997.csv", delim=";", locale=locale("it"),
col_types = cols(
col_date("%d-%b-%y"),
col_time("%H.%M"),
col_number(),
col_skip(),
col_skip()),
col_names=c("date", "time", "level"),
skip=1)
data_1998 <- read_delim("../data/tides/Punta_Salute_1998.csv", delim=";", locale=locale("it"),
col_types = cols(
col_date("%d-%b-%y"),
col_time("%H.%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1)
data_1999 <- read_delim("../data/tides/Punta_Salute_1999.csv", delim=";", locale=locale("it"),
col_types = cols(
col_date("%d-%b-%y"),
col_time("%H.%M"),
col_number(),
col_skip(),
col_skip(),
col_skip()),
col_names=c("date", "time", "level"),
skip=1,
n_max=24*365)
data_2000 <- read_delim("../data/tides/Punta_Salute_2000.csv", delim=";", locale=locale("it"),
col_types = cols(
col_date("%d-%b-%y"),
col_time("%H.%M"),
col_number(),
col_skip(),
col_skip(),
col_skip()),
col_names=c("date", "time", "level"),
skip=1,
n_max=24*366)
data_2001 <- read_delim("../data/tides/Punta_Salute_2001.csv", delim=";", locale=locale("it"),
col_types = cols_only(
col_date("%d-%b-%y"),
col_time("%H:%M"),
col_number(),
col_skip(),
col_skip(),
col_skip()),
col_names=c("date", "time", "level"),
skip=1,
n_max=24*365)
data_2002 <- read_delim("../data/tides/Punta_Salute_2002.csv", delim=";", locale=locale("it"),
col_types = cols_only(
col_date("%d-%b-%y"),
col_time("%H:%M"),
col_number(),
col_skip(),
col_skip(),
col_skip()),
col_names=c("date", "time", "level"),
skip=1,
n_max=24*365)
data_2003 <- read_delim("../data/tides/Punta_Salute_2003.csv", delim=";", locale=locale("it"),
col_types = cols_only(
col_date("%d-%b-%y"),
col_time("%H:%M"),
col_number(),
col_skip(),
col_skip(),
col_skip()),
col_names=c("date", "time", "level"),
skip=1,
n_max=24*365)
data_2004 <- read_delim("../data/tides/Punta_Salute_2004.csv", delim=";", locale=locale("it"),
col_types = cols_only(
col_date("%d-%b-%y"),
col_time("%H:%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1)
data_2005 <- read_delim("../data/tides/Punta_Salute_2005.csv", delim=";", locale=locale("it"),
col_types = cols_only(
col_date("%d-%b-%y"),
col_time("%H:%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1,
n_max=24*365)
data_2006 <- read_delim("../data/tides/Punta_Salute_2006.csv", delim=";", locale=locale("it"),
col_types = cols_only(
col_date("%d-%b-%y"),
col_time("%H.%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1,
n_max=24*365)
data_2007 <- read_delim("../data/tides/Punta_Salute_2007.csv", delim=";",
col_types = cols_only(
col_date("%d/%m/%y"),
col_time("%H.%M"),
col_number(),
col_skip(),
col_skip(),
col_skip(),
col_skip(),
col_skip(),
col_skip()),
col_names=c("date", "time", "level"),
skip=1,
n_max=24*365)
data_2008 <- read_delim("../data/tides/Punta_Salute_2008.csv", delim=";", locale=locale("it"),
col_types = cols(
col_date("%d-%b-%y"),
col_time("%H:%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1)
data_2009 <- read_delim("../data/tides/Punta_Salute_2009.csv", delim=";", locale=locale("it"),
col_types = cols(
col_date("%d-%b-%y"),
col_time("%H:%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1,
n_max=24*365)
data_2010 <- read_delim("../data/tides/Punta_Salute_2010.csv", delim=";",
col_types = cols_only(
col_date("%d/%m/%Y"),
col_time("%H.%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1)
data_2011 <- read_delim("../data/tides/Punta_Salute_2011.csv", delim=";",
col_types = cols_only(
col_date("%d/%m/%Y"),
col_time("%H:%M"),
col_number(),
col_skip()),
col_names=c("date", "time", "level"),
skip=1,
n_max=24*365)
data_2012 <- read_delim("../data/tides/Punta_Salute_2012.csv", delim=";",
col_types = cols_only(
col_date("%d/%m/%Y"),
col_time("%H:%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1)
data_2013 <- read_delim("../data/tides/Punta_Salute_2013.csv", delim=";",
col_types = cols_only(
col_date("%d/%m/%Y"),
col_time("%H:%M"),
col_number(),
col_skip()),
col_names=c("date", "time", "level"),
skip=1,
n_max=24*365)
data_2014 <- read_delim("../data/tides/Punta_Salute_2014.csv", delim=";",
col_types = cols_only(
col_date("%d/%m/%Y"),
col_time("%H:%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1,
n_max=24*365)
data_2015 <- read_delim("../data/tides/Punta_Salute_2015.csv", delim=";",
col_types = cols_only(
col_date("%d/%m/%Y"),
col_time("%H:%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1,
n_max=24*365)
data_2016 <- read_delim("../data/tides/Punta_Salute_2016.csv", delim=";",
col_types = cols_only(
col_date("%d/%m/%Y"),
col_time("%H:%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1)
data_2017 <- read_delim("../data/tides/Punta_Salute_2017.csv", delim=";",
col_types = cols_only(
col_date("%d/%m/%Y"),
col_time("%H:%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1)
data_2018 <- read_delim("../data/tides/Punta_Salute_2018.csv", delim=";",
col_types = cols_only(
col_date("%d/%m/%Y"),
col_time("%H:%M"),
col_number()),
col_names=c("date", "time", "level"),
skip=1)
data_2018$level <- data_2018$level*100
data_years <- 1983:2018
tt <- list(data_1983, data_1984, data_1985, data_1986, data_1987, data_1988, data_1989, data_1990,
data_1991, data_1992, data_1993, data_1994, data_1995, data_1996, data_1997, data_1998,
data_1999, data_2000, data_2001, data_2002, data_2003, data_2004, data_2005, data_2006,
data_2007, data_2008, data_2009, data_2010, data_2011, data_2012, data_2013, data_2014,
data_2015, data_2016, data_2017, data_2018)
names(tt) <- as.character(data_years)
sapply(names(tt), function(d) head(tt[[d]]["time"],1)==3600 && head(tt[[d]]["date"],1)==paste0(d,'-1-1'))
sapply(names(tt), function(d) tail(tt[[d]]["time"],1)==0 && tail(tt[[d]]["date"],1)==paste0(as.integer(d)+1,'-1-1'))
sapply(names(tt), function(d) nrow(tt[[d]])==ifelse(leap_year(as.integer(d)), 24*366, 24*365))
sapply(names(tt), function(d) nrow(tt[[d]])==ifelse(leap_year(as.integer(d)), 24*366, 24*365))
sapply(tt, anyNA)
result_tmp <- do.call(rbind, tt)
result <- data.frame(datetime= (result_tmp$date + seconds(result_tmp$time)),
level=result_tmp$level)
result_xts <- xts(order.by=(result_tmp$date + seconds(result_tmp$time)),
x=result_tmp$level)
attr(result_xts, 'frequency') <- 24
write.zoo(result_xts, file="../data/output/venezia_xts.csv", col.names=c("datetime", "level"))
write.csv(result, file="../data/output/venezia.csv", row.names = FALSE)
data_rain_1983_1984 <- read_delim("../new_data/dati_meteo/DB_OSSERVATORIO_1980_1984.csv", delim=";",
col_types = cols_only(
col_date("%d/%m/%Y"),
col_time("%H.%M"),
col_skip(),
col_skip(),
col_number(),
col_number(),
col_skip(),
col_number(),
col_skip()),
col_names=c("date", "time", "dir_wind", "vel_wind", "rain"),
skip=26306)
data_rain_1983_1984[is.na(data_rain_1983_1984)] <- 0.0
data_rain_1985_1989 <- read_delim("../new_data/dati_meteo/DB_OSSERVATORIO_1985_1989.csv", delim=";",
col_types = cols_only(
col_date("%d/%m/%Y"),
col_time("%H.%M"),
col_skip(),
col_skip(),
col_number(),
col_number(),
col_skip(),
col_number(),
col_skip()),
col_names=c("date", "time", "dir_wind", "vel_wind", "rain"),
skip=2)
data_rain_1985_1989[is.na(data_rain_1985_1989)] <- 0.0
data_rain_1990_1994 <- read_delim("../new_data/dati_meteo/DB_OSSERVATORIO_1990_1994.csv", delim=";",
col_types = cols_only(
col_date("%d/%m/%Y"),
col_time("%H.%M"),
col_skip(),
col_skip(),
col_number(),
col_number(),
col_skip(),
col_number(),
col_skip()),
col_names=c("date", "time", "dir_wind", "vel_wind", "rain"),
skip=2)
data_rain_1990_1994[is.na(data_rain_1990_1994)] <- 0.0
data_rain_1995_1999 <- read_delim("../new_data/dati_meteo/DB_OSSERVATORIO_1995_1999.csv", delim=";",
col_types = cols_only(
col_date("%d/%m/%Y"),
col_time("%H.%M"),
col_skip(),
col_skip(),
col_number(),
col_number(),
col_skip(),
col_number(),
col_skip()),
col_names=c("date", "time", "dir_wind", "vel_wind", "rain"),
skip=2)
data_rain_1995_1999[is.na(data_rain_1995_1999)] <- 0.0
data_rain_2000_2002 <- read_delim("../new_data/dati_meteo/DB_OSSERVATORIO_2000_2002.csv", delim=";",
col_types = cols_only(
col_date("%d/%m/%Y"),
col_time("%H.%M"),
col_skip(),
col_skip(),
col_number(),
col_number(),
col_skip(),
col_number(),
col_skip()),
col_names=c("date", "time", "dir_wind", "vel_wind", "rain"),
skip=2)
data_rain_2000_2002[is.na(data_rain_2000_2002)] <- 0.0
tt <- list(data_rain_1983_1984, data_rain_1985_1989, data_rain_1990_1994,
data_rain_1995_1999, data_rain_2000_2002)
sapply(tt, anyNA)
result_tmp <- do.call(rbind, tt)
result <- data.frame(datetime= (result_tmp$date + seconds(result_tmp$time)),
dir_wind=result_tmp$dir_wind,
vel_wind = result_tmp$vel_wind,
rain = result_tmp$rain)
result %>% filter(datetime > "1984-12-31 23:00:00")
head(result)
tail(result)
tides <- read.csv("../data/output/venezia.csv")
head(tides)
tides$datetime <- as.POSIXct(tides$datetime, format = "%Y-%m-%d %H:%M:%OS")
tides %>% filter(datetime <= "2002-12-31 23:00:00") -> tides_filtered
head(tides_filtered)
tail(tides_filtered)
head(result_tmp)
tail(result_tmp)
tides %>% filter()
library(dplyr)
library(dplyr)
dplr <- left_join(result, tides_filtered, by=c("datetime","datetime"))
anyNA(dplr)
getwd()
